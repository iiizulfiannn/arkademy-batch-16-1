<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- font Awesome -->
  <link rel="stylesheet" href="./assets/css/all.css">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css?family=Noto+Sans:400,700&display=swap" rel="stylesheet">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="./assets/css/bootstrap.min.css">

  <!-- CSS Custom -->
  <link rel="stylesheet" href="./assets/css/styles.css">

  <title>Arkademy</title>

  <style>
    .search::placeholder {
      color: white !important;
      opacity: 1 !important;
    }

    .modal-content {
      border-radius: 2rem;
    }
  </style>
</head>

<body>

  <!-- Navigation -->
  <nav class="navbar fixed-top p-0 navbar-dark bg-light shadow">
    <!-- Logo -->
    <a class="navbar-brand ml-5 py-0" href="#"><img src="./assets/images/logo.png" width="110" height="77" alt=""></a>
    <!-- Search, Add Button -->
    <form class="form-inline">
      <input style="background-color: gray; color: white;" class="search form-control form-rounded px-3 mr-5"
        type="search" size="100" placeholder="Search...">
      <a class="btn btn-warning btn-lg form-rounded px-5 mx-5 text-white shadow" data-toggle="modal"
        data-target="#add_modal" type="button">ADD</a>
    </form>
  </nav>

  <!-- Modal Add-->
  <form action="/save" method="POST">
    <div class="modal fade" id="add_modal">
      <div class="modal-dialog modal-lg modal-dialog-centered form-rounded-1" role="document">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <h1 class="modal-title ml-4">ADD</h1>
            <button type="button" class="close mr-4" data-dismiss="modal" aria-label="Close">
              <h1><span aria-hidden="true">&times;</span></h1>
            </button>
          </div>
          <!-- Modal Body -->
          <div class="modal-body">

            <!-- Cahier Name -->
            <div class="form-group garis-bawah mb-4">
              <select id="id_cashier" name="id_cashier" class="form-control form-control-lg none-border">
                <% viewCashiers.forEach(function (cashier) { %>

                <option value="<%= cashier.id %>"><%= cashier.name %></option>
                <% }) %>

              </select>
            </div>
            <!-- Category Name -->
            <div class="form-group garis-bawah mb-4">
              <select id="id_category" name="id_category" class="form-control form-control-lg none-border">
                <% viewCategories.forEach(function (category) { %>

                <option value="<%= category.id %>"><%= category.name %></option>
                <% }) %>
              </select>
            </div>
            <!-- Product Name -->
            <div class="form-group garis-bawah mb-4">
              <input type="text" id="name" name="name" class="form-control form-control-lg none-border"
                placeholder="Food or Drink" required>

            </div>
            <!-- Price Product -->
            <div class="form-group garis-bawah mb-4">
              <input type="text" id="price" name="price" class="form-control form-control-lg none-border"
                placeholder="Rp 10000" required>

            </div>
            <!-- Modal Footer -->

            <div class="modal-footer">
              <button class="btn btn-warning btn-lg form-rounded px-5 mx-5 text-white shadow" type="submit">ADD</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>

  <!-- Modal Edit-->
  <form action="/update" method="POST">
    <div class="modal fade" id="edit_modal">
      <div class="modal-dialog modal-lg modal-dialog-centered form-rounded-1" role="document">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <h1 class="modal-title ml-4">EDIT</h1>
            <button type="button" class="close mr-4" data-dismiss="modal" aria-label="Close">
              <h1><span aria-hidden="true">&times;</span></h1>
            </button>
          </div>
          <!-- Modal Body -->
          <div class="modal-body">

            <!-- Cahier Name -->
            <div class="form-group garis-bawah mb-4">
              <select id="id_cashier" name="id_cashier" class="id_cashier form-control form-control-lg none-border">
                <% viewCashiers.forEach(function (cashier) { %>

                <option value="<%= cashier.id %>"><%= cashier.name %></option>
                <% }) %>

              </select>
            </div>
            <!-- Category Name -->
            <div class="form-group garis-bawah mb-4">
              <select id="id_category" name="id_category" class="id_category form-control form-control-lg none-border">
                <% viewCategories.forEach(function (category) { %>

                <option value="<%= category.id %>"><%= category.name %></option>
                <% }) %>
              </select>
            </div>
            <!-- Product Name -->
            <div class="form-group garis-bawah mb-4">
              <input type="text" id="name" name="name" class="name form-control form-control-lg none-border"
                placeholder="Cake" required>

            </div>
            <!-- Price Product -->
            <div class="form-group garis-bawah mb-4">
              <input type="text" id="price" name="price" class="price form-control form-control-lg none-border"
                placeholder="Rp 10000" required>

            </div>
            <!-- Modal Footer -->
            <input type="hidden" name="id" class="id">

            <div class="modal-footer">
              <button class="btn btn-warning btn-lg form-rounded px-5 mx-5 text-white shadow">EDIT</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>

  <!-- Modal Notif Delete -->
  <form id="delete" action="/delete" method="POST">
    <div class="modal fade" id="delete_modal">
      <div class="modal-dialog modal-lg modal-dialog-centered form-rounded-1" role="document">
        <div class="modal-content">
          <!-- Modal Header -->
          <div class="modal-header">
            <h1 class="modal-title ml-4"></h1>
            <button type="button" class="close mr-4" data-dismiss="modal" aria-label="Close">
              <h1><span aria-hidden="true">&times;</span></h1>
            </button>
          </div>
          <!-- Modal Body -->
          <div class="modal-body text-center mb-5 pb-5">
            <input type="hidden" name="id" class="id_delete">
            <h3 id="message"></h3>
            <i class="far fa-check-circle"></i>
            <h3>Berhasil Dihapus </h3>
          </div>
        </div>
      </div>
    </div>
  </form>

  <!-- Content -->
  <div class="container">
    <div class="row mt-table">
      <table id="myTable" class="table table-borderless form-rounded-1 shadow text-center">
        <!-- Table Header -->
        <thead class="bg-warning text-light">
          <tr>
            <th scope="col" class="col-number">No</th>
            <th scope="col">Cashier</th>
            <th scope="col">Product</th>
            <th scope="col">Category</th>
            <th scope="col">Price</th>
            <th scope="col" class="col-action">Action</th>
          </tr>
        </thead>
        <!-- Table Body -->
        <tbody id="newRowProduct">
          <!-- Container Show The Table -->
          <% viewPoss.forEach(function (pos, index) { %>

          <tr>
            <th scope="row"><%= index+1 %></th>
            <td><%= pos.nameCashier %></td>
            <td><%= pos.nameProduct %></td>
            <td><%= pos.nameCategory %></td>
            <td id="rupiah"><%= pos.priceProduct %></td>
            <td><a href="javascript:void(0);" class="edit" data-id="<%= pos.idProduct %>"
                data-price="<%= pos.priceProduct %>" data-name="<%= pos.nameProduct %>"
                data-id_category="<%= pos.idCategory %>" data-id_cashier="<%= pos.idCashier %>"><i
                  class="far fa-edit hijau"></i></a>
              <a href="javascript:void(0);" class="delete" data-id="<%= pos.idProduct %>"
                data-name_cashier="<%= pos.nameCashier %>"><i class="fas fa-trash-alt merah"></i></a>
            </td>
          </tr>

          <% }) %>

        </tbody>
      </table>
    </div>
  </div>

  <script src="./assets/js/jquery3.4.1.min.js"></script>
  <script src="./assets/js/propper.min.js"></script>
  <script src="./assets/js/bootstrap.min.js"></script>

  <script>
    $(document).ready(function () {

      // FORMAT RUPIAH
      $('[id="rupiah"]').each(function () {
        var bilangan = $(this).text();
        var reverse = bilangan.toString().split('').reverse().join('');
        var ribuan = reverse.match(/\d{1,3}/g);
        ribuan = ribuan.join('.').split('').reverse().join('');
        $(this).text(`Rp. ${ribuan}`);
      });

      // UPDATE
      $('#myTable').on('click', '.edit', function () {
        var name = $(this).data('name');
        var price = $(this).data('price');
        var id_category = $(this).data('id_category');
        var id_cashier = $(this).data('id_cashier');
        var id = $(this).data('id');
        $('#edit_modal').modal('show');
        $('.name').val(name);
        $('.price').val(price);
        $('.id_category').val(id_category);
        $('.id_cashier').val(id_cashier);
        $('.id').val(id);
      });

      // MESSAGE DELETE MODAL
      $('#myTable').on('click', '.delete', function () {
        var id = $(this).data('id');
        var name_cashier = $(this).data('name_cashier');
        $('#delete_modal').modal('show');
        $('#message').html(`Data ${name_cashier} ID <span style="color: orange">#${id}</span>`);
        $('.id_delete').val(id);
        setTimeout(function () {
          $('#delete').submit();
        }, 1500);
      });

    });

  </script>

</body>
</html>